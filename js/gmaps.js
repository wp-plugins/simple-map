/*!
 * GMaps.js v0.3.3
 * http://hpneo.github.com/gmaps/
 *
 * Copyright 2012, Gustavo Leon
 * Released under the MIT License.
 */
if(window.google&&window.google.maps){var GMaps=(function(c){var d=document;var b=function(g,e){var f;if("jQuery" in c&&e){f=$("#"+g.replace("#",""),e)[0]}else{f=d.getElementById(g.replace("#",""))}return f};var a=function(k){var x=this;var m=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"];var q=["mousemove","mouseout","mouseover"];window.context_menu={};if(typeof(k.el)==="string"||typeof(k.div)==="string"){this.el=b(k.el||k.div,k.context)}else{this.el=k.el||k.div}if(typeof(this.el)==="undefined"||this.el===null){throw"No element defined."}this.el.style.width=k.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=k.height||this.el.scrollHeight||this.el.offsetHeight;this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=k.zoom||15;this.registered_events={};var z=k.markerClusterer;var C;if(k.mapType){C=google.maps.MapTypeId[k.mapType.toUpperCase()]}else{C=google.maps.MapTypeId.ROADMAP}var w=new google.maps.LatLng(k.lat,k.lng);delete k.el;delete k.lat;delete k.lng;delete k.mapType;delete k.width;delete k.height;delete k.markerClusterer;var f=k.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"};var I=k.zoomControl||true,A=f.style||"DEFAULT",g=f.position||"TOP_LEFT",s=k.panControl||true,o=k.mapTypeControl||true,r=k.scaleControl||true,p=k.streetViewControl||true,l=l||true;var y={};var u={zoom:this.zoom,center:w,mapTypeId:C};var e={panControl:s,zoomControl:I,zoomControlOptions:{style:google.maps.ZoomControlStyle[A],position:google.maps.ControlPosition[g]},mapTypeControl:o,scaleControl:r,streetViewControl:p,overviewMapControl:l};if(k.disableDefaultUI!=true){u=extend_object(u,e)}y=extend_object(u,k);for(var B=0;B<m.length;B++){delete y[m[B]]}for(var B=0;B<q.length;B++){delete y[q[B]]}this.map=new google.maps.Map(this.el,y);if(z){this.markerClusterer=z.apply(this,[this.map])}var F=function(J){var K=0;var i=0;if(J.offsetParent){do{K+=J.offsetLeft;i+=J.offsetTop}while(J=J.offsetParent)}return[K,i]};var t=function(N,S){var R="";var W=window.context_menu[N];for(var O in W){if(W.hasOwnProperty(O)){var Q=W[O];R+='<li><a id="'+N+"_"+O+'" href="#">'+Q.title+"</a></li>"}}if(!b("gmaps_context_menu")){return}var T=b("gmaps_context_menu");T.innerHTML=R;var J=T.getElementsByTagName("a");var V=J.length;for(var O=0;O<V;O++){var L=J[O];var M=function(i){i.preventDefault();W[this.id.replace(N+"_","")].action.apply(x,[S]);x.hideContextMenu()};google.maps.event.clearListeners(L,"click");google.maps.event.addDomListenerOnce(L,"click",M,false)}var P=F.apply(this,[x.el]);var K=P[0]+S.pixel.x-15;var U=P[1]+S.pixel.y-15;T.style.left=K+"px";T.style.top=U+"px";T.style.display="block"};var G=function(K,J){if(K==="marker"){J.pixel={};var i=new google.maps.OverlayView();i.setMap(x.map);i.draw=function(){var M=i.getProjection();var L=J.marker.getPosition();J.pixel=M.fromLatLngToContainerPixel(L);t(K,J)}}else{t(K,J)}};this.setContextMenu=function(J){window.context_menu[J.control]={};for(var L in J.options){if(J.options.hasOwnProperty(L)){var M=J.options[L];window.context_menu[J.control][M.name]={title:M.title,action:M.action}}}var K=d.createElement("ul");K.id="gmaps_context_menu";K.style.display="none";K.style.position="absolute";K.style.minWidth="100px";K.style.background="white";K.style.listStyle="none";K.style.padding="8px";K.style.boxShadow="2px 2px 6px #ccc";d.body.appendChild(K);var N=b("gmaps_context_menu");google.maps.event.addDomListener(N,"mouseout",function(i){if(!i.relatedTarget||!this.contains(i.relatedTarget)){window.setTimeout(function(){N.style.display="none"},400)}},false)};this.hideContextMenu=function(){var i=b("gmaps_context_menu");if(i){i.style.display="none"}};var v=function(J,i){google.maps.event.addListener(J,i,function(K){if(K==undefined){K=this}k[i].apply(this,[K]);x.hideContextMenu()})};for(var E=0;E<m.length;E++){var H=m[E];if(H in k){v(this.map,H)}}for(var E=0;E<q.length;E++){var H=q[E];if(H in k){v(this.map,H)}}google.maps.event.addListener(this.map,"rightclick",function(i){if(k.rightclick){k.rightclick.apply(this,[i])}if(window.context_menu.map!=undefined){G("map",i)}});this.refresh=function(){google.maps.event.trigger(this.map,"resize")};this.fitZoom=function(){var L=[];var J=this.markers.length;for(var K=0;K<J;K++){L.push(this.markers[K].getPosition())}this.fitLatLngBounds(L)};this.fitLatLngBounds=function(M){var L=M.length;var K=new google.maps.LatLngBounds();for(var J=0;J<L;J++){K.extend(M[J])}this.map.fitBounds(K)};this.setCenter=function(J,i,K){this.map.panTo(new google.maps.LatLng(J,i));if(K){K()}};this.getElement=function(){return this.el};this.zoomIn=function(i){i=i||1;this.zoom=this.map.getZoom()+i;this.map.setZoom(this.zoom)};this.zoomOut=function(i){i=i||1;this.zoom=this.map.getZoom()-i;this.map.setZoom(this.zoom)};var j=[];for(var h in this.map){if(typeof(this.map[h])=="function"&&!this[h]){j.push(h)}}for(var B=0;B<j.length;B++){(function(i,K,J){i[J]=function(){return K[J].apply(K,arguments)}})(this,this.map,j[B])}this.createControl=function(i){var L=d.createElement("div");L.style.cursor="pointer";L.style.fontFamily="Arial, sans-serif";L.style.fontSize="13px";L.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";for(var J in i.style){L.style[J]=i.style[J]}if(i.id){L.id=i.id}if(i.classes){L.className=i.classes}if(i.content){L.innerHTML=i.content}for(var K in i.events){(function(N,M){google.maps.event.addDomListener(N,M,function(){i.events[M].apply(this,[this])})})(L,K)}L.index=1;return L};this.addControl=function(J){var i=google.maps.ControlPosition[J.position.toUpperCase()];delete J.position;var K=this.createControl(J);this.controls.push(K);this.map.controls[i].push(K);return K};this.createMarker=function(T){if((T.hasOwnProperty("lat")&&T.hasOwnProperty("lng"))||T.position){var S=this;var J=T.details;var N=T.fences;var P=T.outside;var M={position:new google.maps.LatLng(T.lat,T.lng),map:null};delete T.lat;delete T.lng;delete T.fences;delete T.outside;var K=extend_object(M,T);var O=new google.maps.Marker(K);O.fences=N;if(T.infoWindow){O.infoWindow=new google.maps.InfoWindow(T.infoWindow);var i=["closeclick","content_changed","domready","position_changed","zindex_changed"];for(var Q=0;Q<i.length;Q++){(function(V,U){if(T.infoWindow[U]){google.maps.event.addListener(V,U,function(W){T.infoWindow[U].apply(this,[W])})}})(O.infoWindow,i[Q])}}var R=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"];var L=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"];for(var Q=0;Q<R.length;Q++){(function(V,U){if(T[U]){google.maps.event.addListener(V,U,function(){T[U].apply(this,[this])})}})(O,R[Q])}for(var Q=0;Q<L.length;Q++){(function(W,V,U){if(T[U]){google.maps.event.addListener(V,U,function(X){if(!X.pixel){X.pixel=W.getProjection().fromLatLngToPoint(X.latLng)}T[U].apply(this,[X])})}})(this.map,O,L[Q])}google.maps.event.addListener(O,"click",function(){this.details=J;if(T.click){T.click.apply(this,[this])}if(O.infoWindow){S.hideInfoWindows();O.infoWindow.open(S.map,O)}});google.maps.event.addListener(O,"rightclick",function(U){U.marker=this;if(T.rightclick){T.rightclick.apply(this,[U])}if(window.context_menu.marker!=undefined){G("marker",U)}});if(O.fences){google.maps.event.addListener(O,"dragend",function(){S.checkMarkerGeofence(O,function(U,V){P(U,V)})})}return O}else{throw"No latitude or longitude defined."}};this.addMarker=function(J){var i;if(J.hasOwnProperty("gm_accessors_")){i=J}else{if((J.hasOwnProperty("lat")&&J.hasOwnProperty("lng"))||J.position){i=this.createMarker(J)}else{throw"No latitude or longitude defined."}}i.setMap(this.map);if(this.markerClusterer){this.markerClusterer.addMarker(i)}this.markers.push(i);a.fire("marker_added",i,this);return i};this.addMarkers=function(L){for(var K=0,J;J=L[K];K++){this.addMarker(J)}return this.markers};this.hideInfoWindows=function(){for(var K=0,J;J=this.markers[K];K++){if(J.infoWindow){J.infoWindow.close()}}};this.removeMarker=function(J){for(var K=0;K<this.markers.length;K++){if(this.markers[K]===J){this.markers[K].setMap(null);this.markers.splice(K,1);a.fire("marker_removed",J,this);break}}return J};this.removeMarkers=function(L){var L=(L||this.markers);for(var K=0;K<this.markers.length;K++){if(this.markers[K]===L[K]){this.markers[K].setMap(null)}}var J=[];for(var K=0;K<this.markers.length;K++){if(this.markers[K].getMap()!=null){J.push(this.markers[K])}}this.markers=J};this.drawOverlay=function(J){var i=new google.maps.OverlayView();i.setMap(x.map);var K=true;if(J.auto_show!=null){K=J.auto_show}i.onAdd=function(){var O=d.createElement("div");O.style.borderStyle="none";O.style.borderWidth="0px";O.style.position="absolute";O.style.zIndex=100;O.innerHTML=J.content;i.el=O;var N=this.getPanes();if(!J.layer){J.layer="overlayLayer"}var L=N[J.layer];L.appendChild(O);var M=["contextmenu","DOMMouseScroll","dblclick","mousedown"];for(var P=0;P<M.length;P++){(function(R,Q){google.maps.event.addDomListener(R,Q,function(S){if(navigator.userAgent.toLowerCase().indexOf("msie")!=-1&&document.all){S.cancelBubble=true;S.returnValue=false}else{S.stopPropagation()}})})(O,M[P])}google.maps.event.trigger(this,"ready")};i.draw=function(){var L=this.getProjection();var N=L.fromLatLngToDivPixel(new google.maps.LatLng(J.lat,J.lng));J.horizontalOffset=J.horizontalOffset||0;J.verticalOffset=J.verticalOffset||0;var O=i.el;var P=O.children[0];var M=P.clientHeight;var Q=P.clientWidth;switch(J.verticalAlign){case"top":O.style.top=(N.y-M+J.verticalOffset)+"px";break;default:case"middle":O.style.top=(N.y-(M/2)+J.verticalOffset)+"px";break;case"bottom":O.style.top=(N.y+J.verticalOffset)+"px";break}switch(J.horizontalAlign){case"left":O.style.left=(N.x-Q+J.horizontalOffset)+"px";break;default:case"center":O.style.left=(N.x-(Q/2)+J.horizontalOffset)+"px";break;case"right":O.style.left=(N.x+J.horizontalOffset)+"px";break}O.style.display=K?"block":"none";if(!K){J.show.apply(this,[O])}};i.onRemove=function(){var L=i.el;if(J.remove){J.remove.apply(this,[L])}else{i.el.parentNode.removeChild(i.el);i.el=null}};x.overlays.push(i);return i};this.removeOverlay=function(J){for(var K=0;K<this.overlays.length;K++){if(this.overlays[K]===J){this.overlays[K].setMap(null);this.overlays.splice(K,1);break}}};this.removeOverlays=function(){for(var J=0,K;K=x.overlays[J];J++){K.setMap(null)}x.overlays=[]};this.drawPolyline=function(R){var Q=[];var O=R.path;if(O.length){if(O[0][0]===undefined){Q=O}else{for(var K=0,J;J=O[K];K++){Q.push(new google.maps.LatLng(J[0],J[1]))}}}var L={map:this.map,path:Q,strokeColor:R.strokeColor,strokeOpacity:R.strokeOpacity,strokeWeight:R.strokeWeight,geodesic:R.geodesic,clickable:true,editable:false,visible:true};if(R.hasOwnProperty("clickable")){L.clickable=R.clickable}if(R.hasOwnProperty("editable")){L.editable=R.editable}if(R.hasOwnProperty("icons")){L.icons=R.icons}if(R.hasOwnProperty("zIndex")){L.zIndex=R.zIndex}var N=new google.maps.Polyline(L);var P=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var M=0;M<P.length;M++){(function(S,i){if(R[i]){google.maps.event.addListener(S,i,function(T){R[i].apply(this,[T])})}})(N,P[M])}this.polylines.push(N);a.fire("polyline_added",N,this);return N};this.removePolyline=function(J){for(var K=0;K<this.polylines.length;K++){if(this.polylines[K]===J){this.polylines[K].setMap(null);this.polylines.splice(K,1);a.fire("polyline_removed",J,this);break}}};this.removePolylines=function(){for(var J=0,K;K=x.polylines[J];J++){K.setMap(null)}x.polylines=[]};this.drawCircle=function(i){i=extend_object({map:this.map,center:new google.maps.LatLng(i.lat,i.lng)},i);delete i.lat;delete i.lng;var J=new google.maps.Circle(i);var L=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var K=0;K<L.length;K++){(function(N,M){if(i[M]){google.maps.event.addListener(N,M,function(O){i[M].apply(this,[O])})}})(J,L[K])}this.polygons.push(J);return J};this.drawRectangle=function(i){i=extend_object({map:this.map},i);var L=new google.maps.LatLngBounds(new google.maps.LatLng(i.bounds[0][0],i.bounds[0][1]),new google.maps.LatLng(i.bounds[1][0],i.bounds[1][1]));i.bounds=L;var J=new google.maps.Rectangle(i);var M=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var K=0;K<M.length;K++){(function(O,N){if(i[N]){google.maps.event.addListener(O,N,function(P){i[N].apply(this,[P])})}})(J,M[K])}this.polygons.push(J);return J};this.drawPolygon=function(i){var L=false;if(i.hasOwnProperty("useGeoJSON")){L=i.useGeoJSON}delete i.useGeoJSON;i=extend_object({map:this.map},i);if(L==false){i.paths=[i.paths.slice(0)]}if(i.paths.length>0){if(i.paths[0].length>0){i.paths=array_flat(array_map(i.paths,arrayToLatLng,L))}}var J=new google.maps.Polygon(i);var M=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"];for(var K=0;K<M.length;K++){(function(O,N){if(i[N]){google.maps.event.addListener(O,N,function(P){i[N].apply(this,[P])})}})(J,M[K])}this.polygons.push(J);a.fire("polygon_added",J,this);return J};this.removePolygon=function(K){for(var J=0;J<this.polygons.length;J++){if(this.polygons[J]===K){this.polygons[J].setMap(null);this.polygons.splice(J,1);a.fire("polygon_removed",K,this);break}}};this.removePolygons=function(){for(var J=0,K;K=x.polygons[J];J++){K.setMap(null)}x.polygons=[]};this.getFromFusionTables=function(J){var L=J.events;delete J.events;var i=J;var K=new google.maps.FusionTablesLayer(i);for(var M in L){(function(O,N){google.maps.event.addListener(O,N,function(P){L[N].apply(this,[P])})})(K,M)}this.layers.push(K);return K};this.loadFromFusionTables=function(i){var J=this.getFromFusionTables(i);J.setMap(this.map);return J};this.getFromKML=function(J){var i=J.url;var L=J.events;delete J.url;delete J.events;var N=J;var K=new google.maps.KmlLayer(i,N);for(var M in L){(function(P,O){google.maps.event.addListener(P,O,function(Q){L[O].apply(this,[Q])})})(K,M)}this.layers.push(K);return K};this.loadFromKML=function(i){var J=this.getFromKML(i);J.setMap(this.map);return J};var D,n;this.getRoutes=function(M){switch(M.travelMode){case"bicycling":D=google.maps.TravelMode.BICYCLING;break;case"transit":D=google.maps.TravelMode.TRANSIT;break;case"driving":D=google.maps.TravelMode.DRIVING;break;default:D=google.maps.TravelMode.WALKING;break}if(M.unitSystem==="imperial"){n=google.maps.UnitSystem.IMPERIAL}else{n=google.maps.UnitSystem.METRIC}var L={avoidHighways:false,avoidTolls:false,optimizeWaypoints:false,waypoints:[]};var K=extend_object(L,M);K.origin=/string/.test(typeof M.origin)?M.origin:new google.maps.LatLng(M.origin[0],M.origin[1]);K.destination=/string/.test(typeof M.destination)?M.destination:new google.maps.LatLng(M.destination[0],M.destination[1]);K.travelMode=D;K.unitSystem=n;delete K.callback;var J=this;var i=new google.maps.DirectionsService();i.route(K,function(N,O){if(O===google.maps.DirectionsStatus.OK){for(var P in N.routes){if(N.routes.hasOwnProperty(P)){J.routes.push(N.routes[P])}}}if(M.callback){M.callback(J.routes)}})};this.removeRoutes=function(){this.routes=[]};this.getElevations=function(J){J=extend_object({locations:[],path:false,samples:256},J);if(J.locations.length>0){if(J.locations[0].length>0){J.locations=array_flat(array_map([J.locations],arrayToLatLng,false))}}var L=J.callback;delete J.callback;var i=new google.maps.ElevationService();if(!J.path){delete J.path;delete J.samples;i.getElevationForLocations(J,function(M,N){if(L&&typeof(L)==="function"){L(M,N)}})}else{var K={path:J.locations,samples:J.samples};i.getElevationAlongPath(K,function(M,N){if(L&&typeof(L)==="function"){L(M,N)}})}};this.cleanRoute=this.removePolylines;this.drawRoute=function(J){var i=this;this.getRoutes({origin:J.origin,destination:J.destination,travelMode:J.travelMode,waypoints:J.waypoints,unitSystem:J.unitSystem,callback:function(K){if(K.length>0){i.drawPolyline({path:K[K.length-1].overview_path,strokeColor:J.strokeColor,strokeOpacity:J.strokeOpacity,strokeWeight:J.strokeWeight});if(J.callback){J.callback(K[K.length-1])}}}})};this.travelRoute=function(K){if(K.origin&&K.destination){this.getRoutes({origin:K.origin,destination:K.destination,travelMode:K.travelMode,waypoints:K.waypoints,callback:function(R){if(R.length>0&&K.start){K.start(R[R.length-1])}if(R.length>0&&K.step){var O=R[R.length-1];if(O.legs.length>0){var N=O.legs[0].steps;for(var P=0,Q;Q=N[P];P++){Q.step_number=P;K.step(Q,(O.legs[0].steps.length-1))}}}if(R.length>0&&K.end){K.end(R[R.length-1])}}})}else{if(K.route){if(K.route.legs.length>0){var J=K.route.legs[0].steps;for(var L=0,M;M=J[L];L++){M.step_number=L;K.step(M)}}}}};this.drawSteppedRoute=function(K){if(K.origin&&K.destination){this.getRoutes({origin:K.origin,destination:K.destination,travelMode:K.travelMode,waypoints:K.waypoints,callback:function(R){if(R.length>0&&K.start){K.start(R[R.length-1])}if(R.length>0&&K.step){var O=R[R.length-1];if(O.legs.length>0){var N=O.legs[0].steps;for(var P=0,Q;Q=N[P];P++){Q.step_number=P;x.drawPolyline({path:Q.path,strokeColor:K.strokeColor,strokeOpacity:K.strokeOpacity,strokeWeight:K.strokeWeight});K.step(Q,(O.legs[0].steps.length-1))}}}if(R.length>0&&K.end){K.end(R[R.length-1])}}})}else{if(K.route){if(K.route.legs.length>0){var J=K.route.legs[0].steps;for(var L=0,M;M=J[L];L++){M.step_number=L;x.drawPolyline({path:M.path,strokeColor:K.strokeColor,strokeOpacity:K.strokeOpacity,strokeWeight:K.strokeWeight});K.step(M)}}}}};this.checkGeofence=function(J,i,K){return K.containsLatLng(new google.maps.LatLng(J,i))};this.checkMarkerGeofence=function(J,L){if(J.fences){for(var K=0,M;M=J.fences[K];K++){var N=J.getPosition();if(!x.checkGeofence(N.lat(),N.lng(),M)){L(J,M)}}}};this.addLayer=function(K,J){J=J||{};var L;switch(K){case"weather":this.singleLayers.weather=L=new google.maps.weather.WeatherLayer();break;case"clouds":this.singleLayers.clouds=L=new google.maps.weather.CloudLayer();break;case"traffic":this.singleLayers.traffic=L=new google.maps.TrafficLayer();break;case"transit":this.singleLayers.transit=L=new google.maps.TransitLayer();break;case"bicycling":this.singleLayers.bicycling=L=new google.maps.BicyclingLayer();break;case"panoramio":this.singleLayers.panoramio=L=new google.maps.panoramio.PanoramioLayer();L.setTag(J.filter);delete J.filter;if(J.click){google.maps.event.addListener(L,"click",function(N){J.click(N);delete J.click})}break;case"places":this.singleLayers.places=L=new google.maps.places.PlacesService(this.map);if(J.search||J.nearbySearch){var i={bounds:J.bounds||null,keyword:J.keyword||null,location:J.location||null,name:J.name||null,radius:J.radius||null,rankBy:J.rankBy||null,types:J.types||null};if(J.search){L.search(i,J.search)}if(J.nearbySearch){L.nearbySearch(i,J.nearbySearch)}}if(J.textSearch){var M={bounds:J.bounds||null,location:J.location||null,query:J.query||null,radius:J.radius||null};L.textSearch(M,J.textSearch)}break}if(L!==undefined){if(typeof L.setOptions=="function"){L.setOptions(J)}if(typeof L.setMap=="function"){L.setMap(this.map)}return L}};this.removeLayer=function(K){if(typeof(K)=="string"&&this.singleLayers[K]!==undefined){this.singleLayers[K].setMap(null);delete this.singleLayers[K]}else{for(var J=0;J<this.layers.length;J++){if(this.layers[J]===K){this.layers[J].setMap(null);this.layers.splice(J,1);break}}}};this.toImage=function(K){var K=K||{};var M={};M.size=K.size||[this.el.clientWidth,this.el.clientHeight];M.lat=this.getCenter().lat();M.lng=this.getCenter().lng();if(this.markers.length>0){M.markers=[];for(var L=0;L<this.markers.length;L++){M.markers.push({lat:this.markers[L].getPosition().lat(),lng:this.markers[L].getPosition().lng()})}}if(this.polylines.length>0){var J=this.polylines[0];M.polyline={};M.polyline["path"]=google.maps.geometry.encoding.encodePath(J.getPath());M.polyline["strokeColor"]=J.strokeColor;M.polyline["strokeOpacity"]=J.strokeOpacity;M.polyline["strokeWeight"]=J.strokeWeight}return a.staticMapURL(M)};this.addMapType=function(i,J){if(J.hasOwnProperty("getTileUrl")&&typeof(J.getTileUrl)=="function"){J.tileSize=J.tileSize||new google.maps.Size(256,256);var K=new google.maps.ImageMapType(J);this.map.mapTypes.set(i,K)}else{throw"'getTileUrl' function required."}};this.addOverlayMapType=function(i){if(i.hasOwnProperty("getTile")&&typeof(i.getTile)=="function"){var J=i.index;delete i.index;this.map.overlayMapTypes.insertAt(J,i)}else{throw"'getTile' function required."}};this.removeOverlayMapType=function(i){this.map.overlayMapTypes.removeAt(i)};this.addStyle=function(J){var i=new google.maps.StyledMapType(J.styles,J.styledMapName);this.map.mapTypes.set(J.mapTypeId,i)};this.setStyle=function(i){this.map.setMapTypeId(i)};this.createPanorama=function(i){if(!i.hasOwnProperty("lat")||!i.hasOwnProperty("lng")){i.lat=this.getCenter().lat();i.lng=this.getCenter().lng()}this.panorama=a.createPanorama(i);this.map.setStreetView(this.panorama);return this.panorama};this.on=function(J,i){return a.on(J,this,i)};this.off=function(i){a.off(i,this)}};a.createPanorama=function(f){var j=b(f.el,f.context);f.position=new google.maps.LatLng(f.lat,f.lng);delete f.el;delete f.context;delete f.lat;delete f.lng;var k=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"];var e=extend_object({visible:true},f);for(var h=0;h<k.length;h++){delete e[k[h]]}var g=new google.maps.StreetViewPanorama(j,e);for(var h=0;h<k.length;h++){(function(l,i){if(f[i]){google.maps.event.addListener(l,i,function(){f[i].apply(this)})}})(g,k[h])}return g};a.Route=function(e){this.map=e.map;this.route=e.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray(),strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeWeight:e.strokeWeight}).getPath();this.back=function(){if(this.step_count>0){this.step_count--;var g=this.route.legs[0].steps[this.step_count].path;for(var f in g){if(g.hasOwnProperty(f)){this.polyline.pop()}}}};this.forward=function(){if(this.step_count<this.steps_length){var g=this.route.legs[0].steps[this.step_count].path;for(var f in g){if(g.hasOwnProperty(f)){this.polyline.push(g[f])}}this.step_count++}}};a.geolocate=function(e){var f=e.always||e.complete;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(g){e.success(g);if(f){f()}},function(g){e.error(g);if(f){f()}},e.options)}else{e.not_supported();if(f){f()}}};a.geocode=function(e){this.geocoder=new google.maps.Geocoder();var f=e.callback;if(e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")){e.latLng=new google.maps.LatLng(e.lat,e.lng)}delete e.lat;delete e.lng;delete e.callback;this.geocoder.geocode(e,function(h,g){f(h,g)})};a.staticMapURL=function(f){var k=[];var x;var g="http://maps.googleapis.com/maps/api/staticmap";if(f.url){g=f.url;delete f.url}g+="?";var v=f.markers;delete f.markers;if(!v&&f.marker){v=[f.marker];delete f.marker}var q=f.polyline;delete f.polyline;if(f.center){k.push("center="+f.center);delete f.center}else{if(f.address){k.push("center="+f.address);delete f.address}else{if(f.lat){k.push(["center=",f.lat,",",f.lng].join(""));delete f.lat;delete f.lng}else{if(f.visible){var e=encodeURI(f.visible.join("|"));k.push("visible="+e)}}}}var o=f.size;if(o){if(o.join){o=o.join("x")}delete f.size}else{o="630x300"}k.push("size="+o);if(!f.zoom){f.zoom=15}var w=f.hasOwnProperty("sensor")?!!f.sensor:true;delete f.sensor;k.push("sensor="+w);for(var l in f){if(f.hasOwnProperty(l)){k.push(l+"="+f[l])}}if(v){var m,n;for(var t=0;x=v[t];t++){m=[];if(x.size&&x.size!=="normal"){m.push("size:"+x.size)}else{if(x.icon){m.push("icon:"+encodeURI(x.icon))}}if(x.color){m.push("color:"+x.color.replace("#","0x"))}if(x.label){m.push("label:"+x.label[0].toUpperCase())}n=(x.address?x.address:x.lat+","+x.lng);if(m.length||t===0){m.push(n);m=m.join("|");k.push("markers="+encodeURI(m))}else{m=k.pop()+encodeURI("|"+n);k.push(m)}}}function u(i,j){if(i[0]==="#"){i=i.replace("#","0x");if(j){j=parseFloat(j);j=Math.min(1,Math.max(j,0));if(j===0){return"0x00000000"}j=(j*255).toString(16);if(j.length===1){j+=j}i=i.slice(0,8)+j}}return i}if(q){x=q;q=[];if(x.strokeWeight){q.push("weight:"+parseInt(x.strokeWeight,10))}if(x.strokeColor){var r=u(x.strokeColor,x.strokeOpacity);q.push("color:"+r)}if(x.fillColor){var y=u(x.fillColor,x.fillOpacity);q.push("fillcolor:"+y)}var p=x.path;if(p.join){for(var s=0,h;h=p[s];s++){q.push(h.join(","))}}else{q.push("enc:"+p)}q=q.join("|");k.push("path="+encodeURI(q))}k=k.join("&");return g+k};a.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"];a.on=function(h,e,g){if(a.custom_events.indexOf(h)==-1){return google.maps.event.addListener(e,h,g)}else{var f={handler:g,eventName:h};e.registered_events[h]=e.registered_events[h]||[];e.registered_events[h].push(f);return f}};a.off=function(f,e){if(a.custom_events.indexOf(f)==-1){google.maps.event.clearListeners(e,f)}else{e.registered_events[f]=[]}};a.fire=function(j,e,h){if(a.custom_events.indexOf(j)==-1){google.maps.event.trigger(e,j,Array.prototype.slice.apply(arguments).slice(2))}else{if(j in h.registered_events){var g=h.registered_events[j];for(var f=0;f<g.length;f++){(function(l,k,i){l.apply(k,[i])})(g[f]["handler"],h,e)}}}};if(!google.maps.Polygon.prototype.getBounds){google.maps.Polygon.prototype.getBounds=function(g){var f=new google.maps.LatLngBounds();var k=this.getPaths();var j;for(var h=0;h<k.getLength();h++){j=k.getAt(h);for(var e=0;e<j.getLength();e++){f.extend(j.getAt(e))}}return f}}if(!google.maps.Polygon.prototype.containsLatLng){google.maps.Polygon.prototype.containsLatLng=function(k){var e=this.getBounds();if(e!==null&&!e.contains(k)){return false}var g=false;var f=this.getPaths().getLength();for(var h=0;h<f;h++){var r=this.getPaths().getAt(h);var n=r.getLength();var l=n-1;for(var m=0;m<n;m++){var q=r.getAt(m);var o=r.getAt(l);if(q.lng()<k.lng()&&o.lng()>=k.lng()||o.lng()<k.lng()&&q.lng()>=k.lng()){if(q.lat()+(k.lng()-q.lng())/(o.lng()-q.lng())*(o.lat()-q.lat())<k.lat()){g=!g}}l=m}}return g}}google.maps.LatLngBounds.prototype.containsLatLng=function(e){return this.contains(e)};google.maps.Marker.prototype.setFences=function(e){this.fences=e};google.maps.Marker.prototype.addFence=function(e){this.fences.push(e)};return a}(this));var coordsToLatLngs=function(b,c){var d=b[0];var a=b[1];if(c){d=b[1];a=b[0]}return new google.maps.LatLng(d,a)};var arrayToLatLng=function(b,c){for(var a=0;a<b.length;a++){if(b[a].length>0&&typeof(b[a][0])!="number"){b[a]=arrayToLatLng(b[a],c)}else{b[a]=coordsToLatLngs(b[a],c)}}return b};var extend_object=function(b,c){if(b===c){return b}for(var a in c){b[a]=c[a]}return b};var replace_object=function(c,b){if(c===b){return c}for(var a in b){if(c[a]!=undefined){c[a]=b[a]}}return c};var array_map=function(f,e){var b=Array.prototype.slice.call(arguments,2);if(Array.prototype.map&&f.map===Array.prototype.map){return Array.prototype.map.call(f,function(g){callback_params=b;callback_params.splice(0,0,g);return e.apply(this,callback_params)})}else{var d=[];var a=f.length;for(var c=0;c<a;c++){callback_params=b;callback_params=callback_params.splice(0,0,f[c]);d.push(e.apply(this,callback_params))}return d}};var array_flat=function(b){new_array=[];for(var a=0;a<b.length;a++){new_array=new_array.concat(b[a])}return new_array}}else{throw"Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true."};